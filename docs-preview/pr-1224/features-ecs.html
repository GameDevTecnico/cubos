<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Feature Guide &raquo; ECS | Cubos Docs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="Favicon.png" type="image/png" />
  <link rel="next" href="features-plugins.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://gamedevtecnico.github.io/cubos/"><img src="Favicon.png" alt="" />Cubos</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">Docs</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="modules.html">Modules</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="features.html">Feature Guide</a> &raquo;</span>
          ECS
        </h1>
        <p>What is an ECS and how it&#x27;s used in <strong>Cubos</strong></p>
<p><a name="md_docs_pages_2_features_ecs"></a></p><p><a href="https://en.wikipedia.org/wiki/Entity_component_system">Wikipedia</a> defines ECS as:</p><blockquote><p>Entity Component System (ECS) is a software architectural pattern mostly used in video game development for the representation of game world objects. An ECS comprises entities composed from components of data, with systems which operate on entities&#x27; components.</p><p>ECS follows the principle of composition over inheritance, meaning that every entity is defined not by a type hierarchy, but by the components that are associated with it. Systems act globally over all entities which have the required components.</p></blockquote><p>The ECS thus is a vital part of the engine, since all of the rest is structured around it in some way. This sets the engine apart from other engines which follow a more traditional model, like <em>Unity</em>, <em>Unreal</em> and <em>Godot</em>.</p><section id="autotoc_md9"><h2><a href="#autotoc_md9">A primer on ECS</a></h2><section id="autotoc_md10"><h3><a href="#autotoc_md10">Why are we using this?</a></h3><p>ECS is a powerful pattern which has been becoming more popular over the years, and even <em>Unity</em> has started integrating it into its engine. The main advantages are flexibility and performance: it avoids a lot of the problems that come with traditional object-oriented programming, and regarding performance, it excels in situations where the number of entities is high, since it makes use of cache locality. Its also easier to parallelize the systems, since they have clearly defined dependencies.</p></section><section id="autotoc_md11"><h3><a href="#autotoc_md11">Our implementation</a></h3><p><strong>Cubos</strong> ECS contains the following concepts:</p><ul><li><strong>Cubos</strong> - used to configure and run an ECS world and systems.</li><li><strong>World</strong> - the main object that holds all of the ECS state.</li><li><strong>Entities</strong> - represent objects in the game world (e.g. a car, a player, a tree).</li><li><strong>Components</strong> - data associated with an entity (e.g. <a href="structcubos_1_1engine_1_1Position.html" class="m-doc">Position</a>, <a href="structcubos_1_1engine_1_1Rotation.html" class="m-doc">Rotation</a>).</li><li><strong>Relations</strong> - data associated to a pair of entities (e.g., <a href="structcubos_1_1engine_1_1ChildOf.html" class="m-doc">ChildOf</a>, <a href="structcubos_1_1engine_1_1CollidingWith.html" class="m-doc">CollidingWith</a>)</li><li><strong>Resources</strong> - singleton-like objects which are stored per world and which do not belong to a specific entity (e.g. <a href="namespacecubos_1_1engine.html#a426547b7a41f84591b3fd8d967bc5435" class="m-doc">DeltaTime</a>, <a href="classcubos_1_1engine_1_1Input.html" class="m-doc">Input</a>).</li><li><strong>Systems</strong> - functions which operate on resources and entities&#x27; components. This is where the logic is implemented.</li><li><strong>Observers</strong> - basically systems which are called immediately after some event is triggered.</li></ul><p>One important thing to note is that in an ECS the data is completely decoupled from the logic. What this means is that entities and components do not and should not possess any functionality other than storing data. All of the logic is relegated to the systems.</p></section><section id="autotoc_md12"><h3><a href="#autotoc_md12">How do we use it?</a></h3><p>Lets say we want to have multiple objects with positions and velocities, and every frame we want to add their velocities to their positions.</p><p>In a traditional object-oriented approach, we would have something along the lines of:</p><pre class="m-code"><span class="k">class</span><span class="w"> </span><span class="nc">MyObject</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">GameObject</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">    </span><span class="c1">// ...</span>

<span class="w">    </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="n">deltaTime</span><span class="p">)</span><span class="w"> </span><span class="k">override</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">velocity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deltaTime</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">position</span><span class="p">;</span>
<span class="w">    </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">velocity</span><span class="p">;</span>
<span class="p">}</span></pre><p>In <strong>Cubos</strong> there are no game objects. Instead, we would define two components and a <code>DeltaTime</code> resource:</p><pre class="m-code"><span class="k">struct</span><span class="w"> </span><span class="nc">Position</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CUBOS_REFLECT</span><span class="p">;</span>

<span class="w">    </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="w"> </span><span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">Velocity</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CUBOS_REFLECT</span><span class="p">;</span>

<span class="w">    </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="w"> </span><span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">DeltaTime</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">CUBOS_REFLECT</span><span class="p">;</span>

<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="p">};</span></pre><p>So, where does the <code>update</code> logic belong? We put it in a system. Systems are functions whose arguments are of certain types, which you can read more about in the <a href="group__core-ecs.html" class="m-doc">ECS module page</a>.</p><p>To access a resource, simply add a reference to it as an argument. In this case, we won&#x27;t be modifying the delta time, so we will use <code>const DeltaTime&amp;</code>. To access entities and their components, we use the <code>Query</code> argument. In this case we we want to access all entities with both positions and velocities, and modify their positions, so we will use <code>Query&lt;Position&amp;, const Velocity&amp;&gt;</code>.</p><pre class="m-code"><span class="n">cubos</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;integrate velocity&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">call</span><span class="p">([](</span><span class="k">const</span><span class="w"> </span><span class="n">DeltaTime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">Query</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Velocity</span><span class="o">&amp;&gt;</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="w"> </span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">velocity</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">query</span><span class="p">)</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">             </span><span class="n">position</span><span class="o">-&gt;</span><span class="n">vec</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">velocity</span><span class="o">-&gt;</span><span class="n">vec</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">});</span></pre><p>We can then iterate over all queried entities and update their positions using their velocities and the delta time.</p></section></section><section id="autotoc_md13"><h2><a href="#autotoc_md13">Going further</a></h2><section id="autotoc_md14"><h3><a href="#autotoc_md14">Registering types</a></h3><p>Before components, relations and resources are used in a World, they must be registered on it. This should be done once, at the start of the program. For example, using the <strong>Cubos</strong> <a href="classcubos_1_1core_1_1ecs_1_1Cubos.html" class="m-doc">main class</a>, for the previous example we would write:</p><pre class="m-code"><span class="n">cubos</span><span class="p">.</span><span class="n">component</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">cubos</span><span class="p">.</span><span class="n">relation</span><span class="o">&lt;</span><span class="n">ChildOf</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">cubos</span><span class="p">.</span><span class="n">resource</span><span class="o">&lt;</span><span class="n">DeltaTime</span><span class="o">&gt;</span><span class="p">();</span></pre><aside class="m-note m-info"><h4>Note</h4><p>If you&#x27;re working directly with a World, you can use methods such as <a href="classcubos_1_1core_1_1ecs_1_1World.html#a2d4eb893c802cd8f7145cb9c2de3ac89" class="m-doc">World::<wbr />registerComponent()</a> to achieve the same result.</p></aside></section><section id="autotoc_md15"><h3><a href="#autotoc_md15">Commands</a></h3><p>When you have direct access to the World, you can manipulate entities directly:</p><pre class="m-code"><span class="k">auto</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">world</span><span class="p">.</span><span class="n">create</span><span class="p">();</span>
<span class="n">world</span><span class="p">.</span><span class="n">components</span><span class="p">(</span><span class="n">entity</span><span class="p">).</span><span class="n">add</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">world</span><span class="p">.</span><span class="n">components</span><span class="p">(</span><span class="n">entity</span><span class="p">).</span><span class="n">remove</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">world</span><span class="p">.</span><span class="n">components</span><span class="p">(</span><span class="n">entity</span><span class="p">).</span><span class="n">add</span><span class="o">&lt;</span><span class="n">Dead</span><span class="o">&gt;</span><span class="p">();</span>
<span class="n">world</span><span class="p">.</span><span class="n">destroy</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span></pre><p>If necessary, you can access the world in a system through the arguments <code>const World&amp;</code> or <code>World&amp;</code>. However, this is not recommended, since it becomes impossible to know what the system is accessing, and thus we cannot parallelize it.</p><p>Instead, you should use the <a href="classcubos_1_1core_1_1ecs_1_1Commands.html" class="m-doc">Commands</a> argument. Through it you can queue operations to be executed at a later time, when its safe to do so.</p><p>Imagine we want to have spawners which create new entities on their position and then destroy themselves. We can implement this with a system like this:</p><pre class="m-code"><span class="n">cubos</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;spawn entities&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">call</span><span class="p">([](</span><span class="n">Commands</span><span class="w"> </span><span class="n">commands</span><span class="p">,</span><span class="w"> </span><span class="n">Query</span><span class="o">&lt;</span><span class="n">Entity</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Spawner</span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Position</span><span class="o">&amp;&gt;</span><span class="w"> </span><span class="n">spawners</span><span class="p">)</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">         </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">entity</span><span class="p">,</span><span class="w"> </span><span class="n">spawner</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">spawners</span><span class="p">)</span>
<span class="w">         </span><span class="p">{</span>
<span class="w">             </span><span class="n">commands</span><span class="p">.</span><span class="n">create</span><span class="p">()</span>
<span class="w">                     </span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
<span class="w">                     </span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Velocity</span><span class="p">{{</span><span class="mf">0.0F</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0F</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0F</span><span class="p">}});</span>
<span class="w">             </span><span class="n">commands</span><span class="p">.</span><span class="n">destroy</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span>
<span class="w">         </span><span class="p">}</span>
<span class="w">     </span><span class="p">});</span></pre><p>This system iterates over all entities with <code>Spawner</code> and <code>Position</code> components. It creates new entities on their positions with a velocity of <code>(0, 0, 1)</code>, and then destroys the spawner entity. The entities are only actually created and destroyed later on, when the commands are executed.</p></section><section id="autotoc_md16"><h3><a href="#autotoc_md16">Observers</a></h3><p>If you find yourself wanting to apply some logic whenever a given component is added or removed, observers are the right tool for you! For example, one use case that arises frequently when working with <strong>Cubos</strong>, is when you have multiple components that must be added to an entity for it perform some function correctly. This is the case for the <a href="structcubos_1_1engine_1_1Position.html" class="m-doc">Position</a> component. If the entity doesn&#x27;t have a <a href="structcubos_1_1engine_1_1LocalToWorld.html" class="m-doc">LocalToWorld</a> component, then it&#x27;s meaningless. To solve this, we do something along the lines of:</p><pre class="m-code"><span class="n">cubos</span><span class="p">.</span><span class="n">observer</span><span class="p">(</span><span class="s">&quot;add LocalToWorld to positions&quot;</span><span class="p">)</span>
<span class="w">     </span><span class="p">.</span><span class="n">onAdd</span><span class="o">&lt;</span><span class="n">Position</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">     </span><span class="p">.</span><span class="n">without</span><span class="o">&lt;</span><span class="n">LocalToWorld</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">     </span><span class="p">.</span><span class="n">call</span><span class="p">([](</span><span class="n">Commands</span><span class="w"> </span><span class="n">cmds</span><span class="p">,</span><span class="w"> </span><span class="n">Query</span><span class="o">&lt;</span><span class="n">Entity</span><span class="o">&gt;</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">ent</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">query</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">cmds</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span><span class="w"> </span><span class="n">LocalToWorld</span><span class="p">{});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">     </span><span class="p">});</span></pre></section><section id="autotoc_md17"><h3><a href="#autotoc_md17">Relations</a></h3><p>Relations are just like components, but they&#x27;re much more powerful. Instead of being associated to a single entity, they&#x27;re associated to two entities: the &#x27;from&#x27; entity and the &#x27;to&#x27; entity. There are three types of relations:</p><ul><li>Default - relations which have a orientation (e.g. from and to have distinct meanings), and which have no restriction on the number.</li><li>Tree - relations which too have orientation, but with the extra restriction that an entity can only appear in the &#x27;from&#x27; side of at least one instance of the relation type. One example is the <a href="structcubos_1_1engine_1_1ChildOf.html" class="m-doc">ChildOf</a> relation.</li><li>Symmetric - relations whose orientation doesn&#x27;t matter. One example is the <a href="structcubos_1_1engine_1_1CollidingWith.html" class="m-doc">CollidingWith</a> relation.</li></ul><p>They can be created using either <a href="classcubos_1_1core_1_1ecs_1_1Commands.html#a96c064f9a509018cce5efc821dd8a2a6" class="m-doc">Commands::<wbr />relate()</a> or the <a href="classcubos_1_1core_1_1ecs_1_1World.html#adb03790c809616907e573f310e560709" class="m-doc">World::<wbr />relate()</a> methods. They can also be destroyed using <a href="classcubos_1_1core_1_1ecs_1_1Commands.html#a56d02f53cf7a32c6d4ccd65acc83c0cf" class="m-doc">Commands::<wbr />unrelate()</a> or <a href="classcubos_1_1core_1_1ecs_1_1World.html#a6637045fd73f33143cc6f3a9a50e5a8d" class="m-doc">World::<wbr />unrelate()</a>.</p><p>Relations can also be queried in systems - read the multiple-target section on the <a href="features-queries.html" class="m-doc">Queries</a> guide for more information on that.</p></section><section id="autotoc_md18"><h3><a href="#autotoc_md18">Blueprints</a></h3><p>A common pattern in game engines is to have a way to create entities in bundles, such as <em>Unity</em>&#x27;s <em>prefabs</em>. In <strong>Cubos</strong> we call these <em>blueprints</em>. A blueprint is a set of entities and their components, which can be spawned into the world as many times as needed.</p><p>For example, if we wanted to create a blueprint for a motorbike with two wheels:</p><pre class="m-code"><span class="k">auto</span><span class="w"> </span><span class="n">motorbike</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecs</span><span class="o">::</span><span class="n">Blueprint</span><span class="p">();</span>

<span class="k">auto</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">motorbike</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">);</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="p">{...});</span>

<span class="k">auto</span><span class="w"> </span><span class="n">frontWheel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">motorbike</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;front_wheel&quot;</span><span class="p">);</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">frontWheel</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="p">{...});</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">relate</span><span class="p">(</span><span class="n">frontWheel</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">ChildOf</span><span class="p">{});</span>

<span class="k">auto</span><span class="w"> </span><span class="n">backWheel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">motorbike</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;back_wheel&quot;</span><span class="p">);</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">backWheel</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="p">{...});</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">relate</span><span class="p">(</span><span class="n">backWheel</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="n">ChildOf</span><span class="p">{});</span></pre><p>To spawn the blueprint into the world:</p><pre class="m-code"><span class="c1">// You can just spawn the bike as is.</span>
<span class="n">commands</span><span class="p">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">motorbike</span><span class="p">);</span>

<span class="c1">// Lets say we want to spawn the bike in a different position.</span>
<span class="c1">// You can override components of the spawned entities.</span>
<span class="n">commands</span>
<span class="w">    </span><span class="p">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">motorbike</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="p">{...});</span></pre><section id="autotoc_md19"><h4><a href="#autotoc_md19">Merging blueprints</a></h4><p>It&#x27;s possible to merge a blueprint into another one. Lets say we have a blueprint for the wheels of the motorbike:</p><pre class="m-code"><span class="k">auto</span><span class="w"> </span><span class="n">wheel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecs</span><span class="o">::</span><span class="n">Blueprint</span><span class="p">();</span>
<span class="n">wheel</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;wheel&quot;</span><span class="p">);</span></pre><p>When creating the motorbike blueprint, we can merge the wheel blueprint into it:</p><pre class="m-code"><span class="k">auto</span><span class="w"> </span><span class="n">motorbike</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecs</span><span class="o">::</span><span class="n">Blueprint</span><span class="p">();</span>
<span class="k">auto</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">motorbike</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Position</span><span class="p">{...});</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="s">&quot;front&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wheel</span><span class="p">);</span>
<span class="n">motorbike</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="s">&quot;back&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wheel</span><span class="p">);</span></pre><p>When spawning the motorbike blueprint, the entities of the wheel blueprint will be accessible with the prefix we gave them:</p><pre class="m-code"><span class="n">commands</span>
<span class="w">    </span><span class="p">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">motorbike</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;front.wheel&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="w">    </span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;back.wheel&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span></pre></section></section></section>
        <div class="m-note m-dim m-thin m-text-center"><a href="features.html" class="m-doc">Feature Guide</a> | <a href="features-plugins.html" class="m-doc">Plugins &raquo;</a></div>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Cubos Docs. Created with <a href="https://doxygen.org/">Doxygen</a> 1.9.1 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
